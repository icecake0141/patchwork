{% extends "base.html" %}
{% block content %}
<div class="card">
	<h1>Project {{ project_id }}</h1>
	<p><a href="/diff/{{ project_id }}">Diff View</a></p>
</div>

<div class="card">
	<h2>Revisions</h2>
	<ul>
	{% for r in revisions %}
	<li><a href="/projects/{{ project_id }}?revision_id={{ r.revision_id }}">{{ r.revision_id }} ({{ r.created_at }})</a></li>
	{% endfor %}
	</ul>
</div>

{% if chosen %}
<div class="card">
	<h2>Revision {{ chosen.revision_id }}</h2>
	<div class="actions">
		<a href="/revisions/{{ chosen.revision_id }}/export/sessions.csv">Export sessions.csv</a>
		<a href="/revisions/{{ chosen.revision_id }}/export/bom.csv">Export bom.csv</a>
		<a href="/revisions/{{ chosen.revision_id }}/export/result.json">Export result.json</a>
		<a href="/revisions/{{ chosen.revision_id }}/export/wiring.svg">Export wiring.svg</a>
	</div>
	<p>Sessions: {{ result.metrics.session_count }} / Modules: {{ result.metrics.module_count }}</p>
</div>

<div class="card">
	<h2>Rack Topology</h2>
	<table>
	<tr><th>rack_a</th><th>rack_b</th><th>media</th><th>count</th></tr>
	{% for row in topology_rows %}
	<tr>
		<td>{{ row.rack_a }}</td>
		<td>{{ row.rack_b }}</td>
		<td>{{ row.media }}</td>
		<td>{{ row.count }}</td>
	</tr>
	{% endfor %}
	</table>
</div>

<div class="card">
	<h2>Rack Occupancy</h2>
	{% for rack,svg in rack_svgs.items() %}
	<h3>{{ rack }}</h3>
	<div>{{ svg|safe }}</div>
	{% endfor %}
</div>

<div class="card">
	<h2>Cable Wiring Diagram</h2>
	<div>{{ wiring_svg|safe }}</div>
</div>
{% endif %}
{% endblock %}
